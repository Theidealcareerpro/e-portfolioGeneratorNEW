<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Create a professional portfolio with image and CV upload, customizable templates, and live preview.">
  <meta name="robots" content="noindex">
  <title>Create Portfolio - ePortfolio Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <style>
    body { background-color: #f3f4f6; font-family: 'Inter', sans-serif; }
    .fade-in { animation: fadeIn 1s ease-in; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .preview-toggle { display: none; }
    @media (max-width: 640px) { .preview-toggle { display: block; } .preview-hidden { display: none; } }
    .input-error { border-color: #dc2626; }
    .template-default { background-color: #ffffff; color: #1f2937; }
    .template-dark { background-color: #1f2937; color: #f9fafb; }
    .template-vibrant { background-color: #fef3c7; color: #7c2d12; }
    .progress-bar { transition: width 0.3s ease-in-out; }
    .image-preview { transition: opacity 0.3s ease-in-out; }
    .loading-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1000; }
    .loading-overlay.active { display: flex; justify-content: center; align-items: center; }
    .spinner { border: 4px solid #f3f4f6; border-top: 4px solid #3b82f6; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
</head>
<body class="antialiased">
  <div id="root"></div>
  <div id="loading" className="loading-overlay">
    <div className="spinner"></div>
  </div>
  <script type="text/javascript">
    try {
      const { useState, useEffect, useCallback, useRef } = React;
      const jsPDF = window.jspdf && window.jspdf.jsPDF ? window.jspdf.jsPDF : null;
      if (!jsPDF) console.warn('jsPDF library failed to load. PDF generation will be disabled.');

      const initialFormData = {
        name: '', profession: '', tagline: '', summary: '', about: '',
        email: '', phone: '', linkedin: '',
        skills: [{ name: '', proficiency: 50 }],
        projects: [{ title: '', description: '', link: '', category: '' }],
        template: 'default'
      };

      const Header = () => {
        return React.createElement(
          "header",
          { className: "bg-gradient-to-r from-indigo-600 to-blue-500 text-white py-6 sticky top-0 z-50 shadow-lg fade-in", role: "banner" },
          React.createElement(
            "div",
            { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center" },
            React.createElement("h1", { className: "text-3xl font-poppins font-bold" }, "ePortfolio Generator"),
            React.createElement(
              "nav",
              { className: "space-x-6", role: "navigation" },
              React.createElement("a", { href: "index.html#features", className: "hover:text-yellow-400 transition" }, "Features"),
              React.createElement("a", { href: "index.html#how-it-works", className: "hover:text-yellow-400 transition" }, "How It Works"),
              React.createElement("a", { href: "index.html#faq", className: "hover:text-yellow-400 transition" }, "FAQ"),
              React.createElement(
                "a",
                { href: "index.html#feedback", className: "bg-yellow-400 text-gray-900 py-2 px-4 rounded-full font-semibold hover:bg-yellow-500 transition" },
                "Feedback"
              )
            )
          )
        );
      };

      const BuyMeACoffee = () => {
        return React.createElement(
          "section",
          { id: "support", className: "py-16 bg-gray-100 fade-in", role: "region", "aria-labelledby": "support-heading" },
          React.createElement(
            "div",
            { className: "max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center" },
            React.createElement("h2", { id: "support-heading", className: "text-3xl font-poppins font-bold text-gray-800 mb-4" }, "Support This Project"),
            React.createElement("p", { className: "text-lg text-gray-600 mb-8" }, "Love ePortfolio Generator? Help keep it running by buying me a coffee!"),
            React.createElement(
              "a",
              {
                href: "https://www.buymeacoffee.com/theidealcag",
                target: "_blank",
                rel: "noopener noreferrer",
                className: "bg-yellow-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-yellow-600 transition",
                "aria-label": "Support ePortfolio Generator on BuyMeACoffee"
              },
              "Buy Me a Coffee"
            )
          )
        );
      };

      const Footer = () => {
        return React.createElement(
          "footer",
          { className: "bg-gray-800 text-white py-8 fade-in", role: "contentinfo" },
          React.createElement(
            "div",
            { className: "max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" },
            React.createElement(
              "div",
              { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8" },
              React.createElement(
                "div",
                null,
                React.createElement("h3", { className: "text-lg font-poppins font-semibold mb-4" }, "ePortfolio Generator"),
                React.createElement("p", { className: "text-gray-400" }, "Build ATS-friendly CVs, cover letters, and portfolios to boost your career.")
              ),
              React.createElement(
                "div",
                null,
                React.createElement("h3", { className: "text-lg font-poppins font-semibold mb-4" }, "Quick Links"),
                React.createElement(
                  "ul",
                  { className: "space-y-2" },
                  React.createElement("li", null, React.createElement("a", { href: "index.html", className: "text-gray-400 hover:text-yellow-400 transition" }, "Home")),
                  React.createElement("li", null, React.createElement("a", { href: "index.html#features", className: "text-gray-400 hover:text-yellow-400 transition" }, "Features")),
                  React.createElement("li", null, React.createElement("a", { href: "index.html#faq", className: "text-gray-400 hover:text-yellow-400 transition" }, "FAQ")),
                  React.createElement("li", null, React.createElement("a", { href: "index.html#feedback", className: "text-gray-400 hover:text-yellow-400 transition" }, "Feedback"))
                )
              ),
              React.createElement(
                "div",
                null,
                React.createElement("h3", { className: "text-lg font-poppins font-semibold mb-4" }, "Connect"),
                React.createElement(
                  "ul",
                  { className: "space-y-2" },
                  React.createElement("li", null, React.createElement("a", { href: "https://github.com/Theidealcareerpro", target: "_blank", rel: "noopener noreferrer", className: "text-gray-400 hover:text-yellow-400 transition" }, "GitHub")),
                  React.createElement("li", null, React.createElement("a", { href: "mailto:theidealcareerpro@gmail.com", className: "text-gray-400 hover:text-yellow-400 transition" }, "Contact Us")),
                  React.createElement("li", null, React.createElement("a", { href: "https://www.buymeacoffee.com/theidealcag", target: "_blank", rel: "noopener noreferrer", className: "text-gray-400 hover:text-yellow-400 transition" }, "Buy Me a Coffee"))
                )
              )
            ),
            React.createElement(
              "div",
              { className: "mt-8 text-center text-gray-400" },
              React.createElement("p", null, `Â© ${new Date().getFullYear()} ePortfolio Generator. All rights reserved.`)
            )
          )
        );
      };

      const FormInput = ({ id, name, label, value, onChange, required, placeholder, error, type = 'text' }) => {
        return React.createElement(
          "div",
          { className: "mb-4" },
          React.createElement(
            "label",
            { htmlFor: id, className: "block text-sm font-medium text-gray-700 mb-2" },
            label,
            required && " *"
          ),
          React.createElement(
            "input",
            {
              type,
              id,
              name,
              value: value || '',
              onChange,
              className: `w-full rounded-md border ${error ? 'input-error' : 'border-gray-300'} shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50`,
              required,
              "aria-required": required,
              placeholder,
              "aria-invalid": !!error
            }
          ),
          error && React.createElement("p", { className: "text-red-500 text-sm mt-1" }, error)
        );
      };

      const FormTextarea = ({ id, name, label, value, onChange, required, placeholder, maxLength, currentLength, error }) => {
        return React.createElement(
          "div",
          { className: "mb-4" },
          React.createElement(
            "label",
            { htmlFor: id, className: "block text-sm font-medium text-gray-700 mb-2" },
            label,
            required && " *"
          ),
          React.createElement(
            "textarea",
            {
              id,
              name,
              value: value || '',
              onChange,
              className: `w-full rounded-md border ${error ? 'input-error' : 'border-gray-300'} shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50`,
              rows: "4",
              required,
              "aria-required": required,
              placeholder,
              maxLength,
              "aria-invalid": !!error
            }
          ),
          maxLength && React.createElement("p", { className: "text-gray-600 text-sm" }, `${currentLength}/${maxLength} characters`),
          error && React.createElement("p", { className: "text-red-500 text-sm mt-1" }, error)
        );
      };

      const FileInput = ({ id, label, accept, onChange, error }) => {
        return React.createElement(
          "div",
          { className: "mb-4" },
          React.createElement("label", { htmlFor: id, className: "block text-sm font-medium text-gray-700 mb-2" }, label),
          React.createElement("input", { type: "file", id, accept, onChange, className: "w-full text-gray-500" }),
          error && React.createElement("p", { className: "text-red-500 text-sm mt-1" }, error)
        );
      };

      const SkillInput = ({ index, skill, onChange, onRemove }) => {
        return React.createElement(
          "div",
          { className: "flex space-x-4 mb-4" },
          React.createElement(
            "div",
            { className: "flex-1" },
            React.createElement("label", { htmlFor: `skill-${index}`, className: "block text-sm font-medium text-gray-700 mb-2" }, `Skill ${index + 1}`),
            React.createElement("input", {
              type: "text",
              id: `skill-${index}`,
              value: skill.name || '',
              onChange: (e) => onChange(index, 'name', e.target.value),
              className: "w-full rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50",
              placeholder: "e.g., JavaScript"
            })
          ),
          React.createElement(
            "div",
            { className: "w-1/3" },
            React.createElement("label", { htmlFor: `proficiency-${index}`, className: "block text-sm font-medium text-gray-700 mb-2" }, "Proficiency (%)"),
            React.createElement("input", {
              type: "number",
              id: `proficiency-${index}`,
              value: skill.proficiency || 50,
              onChange: (e) => onChange(index, 'proficiency', parseInt(e.target.value) || 0),
              min: "0",
              max: "100",
              className: "w-full rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
            })
          ),
          React.createElement(
            "button",
            {
              type: "button",
              onClick: () => onRemove(index),
              className: "mt-8 bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500",
              "aria-label": `Remove skill ${index + 1}`
            },
            "Remove"
          )
        );
      };

      const ProjectInput = ({ index, project, onChange, onRemove }) => {
        return React.createElement(
          "div",
          { className: "mb-4 p-4 bg-gray-50 rounded-lg" },
          React.createElement(FormInput, {
            id: `project-title-${index}`,
            name: `project-title-${index}`,
            label: `Project ${index + 1} Title`,
            value: project.title,
            onChange: (e) => onChange(index, 'title', e.target.value),
            placeholder: "Project Title"
          }),
          React.createElement(FormTextarea, {
            id: `project-description-${index}`,
            name: `project-description-${index}`,
            label: "Description",
            value: project.description,
            onChange: (e) => onChange(index, 'description', e.target.value),
            placeholder: "Describe your project",
            maxLength: 500,
            currentLength: project.description ? project.description.length : 0
          }),
          React.createElement(FormInput, {
            id: `project-link-${index}`,
            name: `project-link-${index}`,
            label: "Project Link (Optional)",
            value: project.link,
            onChange: (e) => onChange(index, 'link', e.target.value),
            type: "url",
            placeholder: "https://project.com"
          }),
          React.createElement(FormInput, {
            id: `project-category-${index}`,
            name: `project-category-${index}`,
            label: "Category",
            value: project.category,
            onChange: (e) => onChange(index, 'category', e.target.value),
            placeholder: "e.g., Web Development"
          }),
          React.createElement(
            "button",
            {
              type: "button",
              onClick: () => onRemove(index),
              className: "bg-red-500 text-white px-3 py-1 rounded-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500",
              "aria-label": `Remove project ${index + 1}`
            },
            "Remove"
          )
        );
      };

      const PortfolioPreview = ({ formData, showPreview, togglePreview, imagePreview, cvFile, cvUrl }) => {
        const skillsList = (formData.skills || []).filter(skill => skill.name);
        const projectsList = (formData.projects || []).filter(project => project.title);
        return React.createElement(
          "div",
          { className: `md:w-1/2 ${showPreview ? '' : 'preview-hidden'}` },
          React.createElement(
            "button",
            {
              onClick: togglePreview,
              className: "preview-toggle bg-blue-600 text-white px-4 py-2 rounded-lg mb-4 md:hidden",
              "aria-label": showPreview ? 'Hide preview' : 'Show preview'
            },
            showPreview ? 'Hide Preview' : 'Show Preview'
          ),
          React.createElement(
            "div",
            { className: `p-6 rounded-lg shadow-md template-${formData.template}` },
            imagePreview
              ? React.createElement("img", {
                  src: imagePreview,
                  alt: "Profile Preview",
                  className: "w-32 h-32 rounded-full mx-auto mb-4 object-cover shadow-md image-preview"
                })
              : React.createElement(
                  "div",
                  { className: "w-32 h-32 rounded-full mx-auto mb-4 bg-gray-200 flex items-center justify-center text-gray-500 image-preview" },
                  "No Image"
                ),
            React.createElement("h2", { className: "text-2xl font-poppins font-semibold mb-2" }, formData.name || 'Your Name'),
            React.createElement("p", { className: "mb-4" }, `${formData.profession || 'Profession'} | ${formData.tagline || 'Tagline'}`),
            React.createElement("h3", { className: "text-xl font-semibold mb-2" }, "About"),
            React.createElement("p", { className: "mb-4" }, formData.about || 'Your about section'),
            React.createElement("h3", { className: "text-xl font-semibold mb-2" }, "Summary"),
            React.createElement("p", { className: "mb-4" }, formData.summary || 'Your summary'),
            React.createElement("h3", { className: "text-xl font-semibold mb-2" }, "Skills"),
            React.createElement(
              "div",
              { className: "space-y-2 mb-4" },
              skillsList.length > 0
                ? skillsList.map((skill, index) =>
                    React.createElement(
                      "div",
                      { key: `skill-${index}` },
                      React.createElement("span", null, skill.name),
                      React.createElement(
                        "div",
                        { className: "w-full bg-gray-200 rounded-full h-2.5" },
                        React.createElement("div", {
                          className: "bg-indigo-600 h-2.5 rounded-full progress-bar",
                          style: { width: `${skill.proficiency}%` }
                        })
                      )
                    )
                  )
                : React.createElement("p", null, "No skills provided")
            ),
            React.createElement("h3", { className: "text-xl font-semibold mb-2" }, "Projects"),
            React.createElement(
              "div",
              { className: "space-y-4 mb-4" },
              projectsList.length > 0
                ? projectsList.map((project, index) =>
                    React.createElement(
                      "div",
                      { key: `project-${index}` },
                      React.createElement("h4", { className: "font-semibold" }, project.title),
                      React.createElement("p", null, project.description || 'Project description'),
                      project.link &&
                        React.createElement(
                          "a",
                          { href: project.link, className: "text-blue-600 hover:underline", target: "_blank", rel: "noopener noreferrer" },
                          project.link
                        ),
                      React.createElement("p", { className: "text-sm" }, project.category || 'Category')
                    )
                  )
                : React.createElement("p", null, "No projects provided")
            ),
            React.createElement("h3", { className: "text-xl font-semibold mb-2" }, "Contact"),
            React.createElement("p", null, formData.email || 'email@example.com'),
            React.createElement("p", null, formData.phone || 'Phone'),
            React.createElement(
              "p",
              null,
              React.createElement(
                "a",
                { href: formData.linkedin || '#', className: "text-blue-600 hover:underline", target: "_blank", rel: "noopener noreferrer" },
                formData.linkedin || 'LinkedIn'
              )
            ),
            cvFile &&
              cvUrl &&
              React.createElement(
                "p",
                { className: "mt-2" },
                React.createElement(
                  "a",
                  { href: cvUrl, className: "text-blue-600 hover:underline", target: "_blank", rel: "noopener noreferrer" },
                  `View Uploaded CV (${cvFile.name})`
                )
              )
          )
        );
      };

      const PortfolioForm = () => {
        const [formData, setFormData] = useState(initialFormData);
        const [imageFile, setImageFile] = useState(null);
        const [imagePreview, setImagePreview] = useState(null);
        const [cvFile, setCvFile] = useState(null);
        const [cvUrl, setCvUrl] = useState(null);
        const [showPreview, setShowPreview] = useState(true);
        const [message, setMessage] = useState('');
        const [errors, setErrors] = useState({});
        const [isLoading, setIsLoading] = useState(false);
        const formRef = useRef(null);

        useEffect(() => {
          try {
            const saved = localStorage.getItem('portfolioForm');
            if (saved) {
              const parsed = JSON.parse(saved);
              setFormData({
                ...initialFormData,
                ...parsed,
                skills: parsed.skills || initialFormData.skills,
                projects: parsed.projects || initialFormData.projects
              });
            }
          } catch (e) {
            console.error('Error parsing localStorage:', e.message);
          }
          return () => {
            if (cvUrl) URL.revokeObjectURL(cvUrl);
          };
        }, []);

        const validateInput = (name, value) => {
          if (['name', 'profession', 'email'].includes(name) && (!value || value.trim().length < 2)) {
            return `${name.charAt(0).toUpperCase() + name.slice(1)} must be at least 2 characters`;
          }
          if (name === 'email' && value && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value)) {
            return 'Please enter a valid email address';
          }
          if (name === 'linkedin' && value && !/^https?:\/\/(www\.)?linkedin\.com\/in\/.+$/.test(value)) {
            return 'Please enter a valid LinkedIn URL';
          }
          return '';
        };

        const validateArrays = () => {
          const errors = {};
          if (!(formData.skills || []).some(skill => skill.name && skill.name.trim())) {
            errors.skills = 'At least one skill is required';
          }
          if (!(formData.projects || []).some(project => project.title && project.title.trim())) {
            errors.projects = 'At least one project is required';
          }
          return errors;
        };

        const handleChange = (e) => {
          const { name, value } = e.target;
          setFormData(prev => {
            const newData = { ...prev, [name]: value };
            try {
              localStorage.setItem('portfolioForm', JSON.stringify(newData));
              setMessage('Data saved locally!');
              setTimeout(() => setMessage(''), 2000);
            } catch (e) {
              console.error('Error saving to localStorage:', e.message);
            }
            return newData;
          });
          setErrors(prev => ({ ...prev, [name]: validateInput(name, value) }));
        };

        const handleSkillChange = (index, field, value) => {
          setFormData(prev => {
            const newSkills = [...(prev.skills || [])];
            newSkills[index] = { ...newSkills[index], [field]: value };
            const newData = { ...prev, skills: newSkills };
            try {
              localStorage.setItem('portfolioForm', JSON.stringify(newData));
              setMessage('Data saved locally!');
              setTimeout(() => setMessage(''), 2000);
            } catch (e) {
              console.error('Error saving to localStorage:', e.message);
            }
            return newData;
          });
        };

        const handleProjectChange = (index, field, value) => {
          setFormData(prev => {
            const newProjects = [...(prev.projects || [])];
            newProjects[index] = { ...newProjects[index], [field]: value };
            const newData = { ...prev, projects: newProjects };
            try {
              localStorage.setItem('portfolioForm', JSON.stringify(newData));
              setMessage('Data saved locally!');
              setTimeout(() => setMessage(''), 2000);
            } catch (e) {
              console.error('Error saving to localStorage:', e.message);
            }
            return newData;
          });
        };

        const addSkill = () => {
          setFormData(prev => ({
            ...prev,
            skills: [...(prev.skills || []), { name: '', proficiency: 50 }]
          }));
        };

        const removeSkill = (index) => {
          setFormData(prev => ({
            ...prev,
            skills: (prev.skills || []).filter((_, i) => i !== index)
          }));
        };

        const addProject = () => {
          setFormData(prev => ({
            ...prev,
            projects: [...(prev.projects || []), { title: '', description: '', link: '', category: '' }]
          }));
        };

        const removeProject = (index) => {
          setFormData(prev => ({
            ...prev,
            projects: (prev.projects || []).filter((_, i) => i !== index)
          }));
        };

        const handleFileChange = (e, type) => {
          const file = e.target.files[0];
          if (type === 'image' && file) {
            if (!file.type.startsWith('image/') || !['image/jpeg', 'image/png'].includes(file.type)) {
              setMessage('Please upload a valid image file (JPEG/PNG).');
              setTimeout(() => setMessage(''), 2000);
              return false;
            }
            if (file.size > 5 * 1024 * 1024) {
              setMessage('Image file size must be under 5MB.');
              setTimeout(() => setMessage(''), 2000);
              return false;
            }
            setImageFile(file);
            const reader = new FileReader();
            reader.onloadend = () => setImagePreview(reader.result);
            reader.onerror = () => {
              setMessage('Error reading image file.');
              setTimeout(() => setMessage(''), 2000);
            };
            reader.readAsDataURL(file);
          } else if (type === 'cv' && file) {
            if (file.type !== 'application/pdf') {
              setMessage('Please upload a valid PDF file for CV.');
              setTimeout(() => setMessage(''), 2000);
              return false;
            }
            if (file.size > 10 * 1024 * 1024) {
              setMessage('CV file size must be under 10MB.');
              setTimeout(() => setMessage(''), 2000);
              return false;
            }
            if (cvUrl) URL.revokeObjectURL(cvUrl);
            setCvFile(file);
            setCvUrl(URL.createObjectURL(file));
          } else {
            if (type === 'image') {
              setImageFile(null);
              setImagePreview(null);
            } else {
              if (cvUrl) URL.revokeObjectURL(cvUrl);
              setCvFile(null);
              setCvUrl(null);
            }
          }
          return true;
        };

        const generatePDF = () => {
          if (!jsPDF) throw new Error('jsPDF is not available.');
          const doc = new jsPDF({ orientation: 'portrait', unit: 'mm', format: 'a4' });
          const pageWidth = 210;
          const margin = 20;
          const maxWidth = pageWidth - 2 * margin;
          let y = margin;

          doc.setFont('helvetica', 'bold');
          doc.setFontSize(16);
          doc.text(formData.name || "Your Name", margin, y, { maxWidth });
          y += 10;

          doc.setFont('helvetica', 'normal');
          doc.setFontSize(12);
          doc.text(`${formData.profession || "Profession"} | ${formData.tagline || "Tagline"}`, margin, y, { maxWidth });
          y += 10;

          doc.text(
            `${formData.email || "Email"} | ${formData.phone || "Phone"} | ${formData.linkedin || "LinkedIn"}`,
            margin,
            y,
            { maxWidth }
          );
          y += 10;

          doc.setFont('helvetica', 'bold');
          doc.setFontSize(14);
          doc.text("Summary", margin, y);
          y += 7;
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(12);
          const summaryLines = doc.splitTextToSize(formData.summary || "Your summary", maxWidth);
          doc.text(summaryLines, margin, y);
          y += summaryLines.length * 7;

          doc.setFont('helvetica', 'bold');
          doc.setFontSize(14);
          doc.text("About", margin, y);
          y += 7;
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(12);
          const aboutLines = doc.splitTextToSize(formData.about || "Your about section", maxWidth);
          doc.text(aboutLines, margin, y);
          y += aboutLines.length * 7;

          doc.setFont('helvetica', 'bold');
          doc.setFontSize(14);
          doc.text("Skills", margin, y);
          y += 7;
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(12);
          (formData.skills || []).forEach(skill => {
            if (skill.name) {
              doc.text(`${skill.name} (${skill.proficiency}%)`, margin, y, { maxWidth });
              y += 7;
            }
          });
          y += 7;

          doc.setFont('helvetica', 'bold');
          doc.setFontSize(14);
          doc.text("Projects", margin, y);
          y += 7;
          doc.setFont('helvetica', 'normal');
          doc.setFontSize(12);
          (formData.projects || []).forEach(project => {
            if (project.title) {
              doc.setFont('helvetica', 'bold');
              doc.text(project.title, margin, y, { maxWidth });
              y += 7;
              doc.setFont('helvetica', 'normal');
              const descLines = doc.splitTextToSize(project.description || "Project description", maxWidth);
              doc.text(descLines, margin, y);
              y += descLines.length * 7;
              if (project.link) {
                doc.text(`Link: ${project.link}`, margin, y, { maxWidth });
                y += 7;
              }
              if (project.category) {
                doc.text(`Category: ${project.category}`, margin, y, { maxWidth });
                y += 7;
              }
            }
          });

          if (cvFile) {
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text("Uploaded CV", margin, y);
            y += 7;
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(12);
            doc.text(`File: ${cvFile.name}`, margin, y, { maxWidth });
            y += 7;
          }

          return doc.output('blob');
        };

        const handleSubmit = useCallback(async (e) => {
          e.preventDefault();
          const newErrors = {};
          ['name', 'profession', 'email', 'linkedin'].forEach(key => {
            const error = validateInput(key, formData[key]);
            if (error) newErrors[key] = error;
          });
          Object.assign(newErrors, validateArrays());
          setErrors(newErrors);

          if (Object.keys(newErrors).length > 0) {
            setMessage('Please fix the errors in the form.');
            formRef.current.scrollIntoView({ behavior: 'smooth' });
            return;
          }

          setIsLoading(true);
          document.getElementById('loading').classList.add('active');
          setMessage('Creating and saving your portfolio...');

          try {
            let pdfBlob = null;
            try {
              pdfBlob = generatePDF();
            } catch (pdfError) {
              console.error('PDF generation failed:', pdfError.message);
              throw new Error('Failed to generate PDF.');
            }

            const data = new FormData();
            for (const key in formData) {
              if (Array.isArray(formData[key])) {
                data.append(key, JSON.stringify(formData[key]));
              } else {
                data.append(key, formData[key]);
              }
            }
            if (imageFile) data.append('image', imageFile);
            if (cvFile) data.append('cv', cvFile);
            if (pdfBlob) data.append('portfolio', pdfBlob, 'portfolio.pdf');

            const response = await fetch('https://portfolio-generator-api.onrender.com/api/generate', {
              method: 'POST',
              body: data
            });

            if (!response.ok) {
              const errorData = await response.json();
              throw new Error(errorData.message || 'API request failed.');
            }

            const result = await response.json();
            setMessage(`Success! Your portfolio is saved at: ${result.portfolio_url}`);
            setFormData(initialFormData);
            setImageFile(null);
            setImagePreview(null);
            if (cvUrl) URL.revokeObjectURL(cvUrl);
            setCvFile(null);
            setCvUrl(null);
            localStorage.removeItem('portfolioForm');

            if (jsPDF) {
              const doc = new jsPDF();
              doc.output('blob');
              doc.save('portfolio.pdf');
            } else {
              setMessage('Portfolio saved, but PDF download failed due to missing jsPDF library.');
            }
          } catch (error) {
            console.error('Submission error:', error.message);
            setMessage(`Error: ${error.message || 'Something went wrong. Please try again.'}`);
          } finally {
            setIsLoading(false);
            document.getElementById('loading').classList.remove('active');
            setTimeout(() => setMessage(''), 5000);
          }
        }, [formData, imageFile, cvFile]);

        return React.createElement(
          "div",
          { className: "container mx-auto px-4 py-8 max-w-6xl fade-in" },
          React.createElement("a", { href: "index.html", className: "text-blue-600 hover:underline mb-4 inline-block" }, "Back to Home"),
          React.createElement("h1", { className: "text-3xl font-poppins font-bold text-gray-800 mb-6" }, "Create Your Portfolio"),
          React.createElement(
            "div",
            { className: "flex flex-col md:flex-row gap-8" },
            React.createElement(
              "div",
              { className: "md:w-1/2", ref: formRef },
              imagePreview &&
                React.createElement(
                  "div",
                  { className: "mb-4" },
                  React.createElement("h3", { className: "text-sm font-medium text-gray-700 mb-2" }, "Profile Image Preview"),
                  React.createElement("img", {
                    src: imagePreview,
                    alt: "Profile Preview",
                    className: "w-32 h-32 rounded-full object-cover shadow-md image-preview"
                  })
                ),
              React.createElement(
                "form",
                { onSubmit: handleSubmit },
                React.createElement(FormInput, {
                  id: "name",
                  name: "name",
                  label: "Full Name",
                  value: formData.name,
                  onChange: handleChange,
                  required: true,
                  placeholder: "John Doe",
                  error: errors.name
                }),
                React.createElement(FormInput, {
                  id: "profession",
                  name: "profession",
                  label: "Profession",
                  value: formData.profession,
                  onChange: handleChange,
                  required: true,
                  placeholder: "Software Developer",
                  error: errors.profession
                }),
                React.createElement(FormInput, {
                  id: "tagline",
                  name: "tagline",
                  label: "Tagline",
                  value: formData.tagline,
                  onChange: handleChange,
                  placeholder: "Building the future, one line of code at a time"
                }),
                React.createElement(FormTextarea, {
                  id: "summary",
                  name: "summary",
                  label: "Summary",
                  value: formData.summary,
                  onChange: handleChange,
                  placeholder: "Brief professional summary",
                  maxLength: 500,
                  currentLength: formData.summary ? formData.summary.length : 0,
                  error: errors.summary
                }),
                React.createElement(FormTextarea, {
                  id: "about",
                  name: "about",
                  label: "About",
                  value: formData.about,
                  onChange: handleChange,
                  placeholder: "Tell us about yourself",
                  maxLength: 1000,
                  currentLength: formData.about ? formData.about.length : 0,
                  error: errors.about
                }),
                React.createElement(FormInput, {
                  id: "email",
                  name: "email",
                  label: "Email",
                  value: formData.email,
                  onChange: handleChange,
                  required: true,
                  type: "email",
                  placeholder: "you@example.com",
                  error: errors.email
                }),
                React.createElement(FormInput, {
                  id: "phone",
                  name: "phone",
                  label: "Phone",
                  value: formData.phone,
                  onChange: handleChange,
                  type: "tel",
                  placeholder: "123-456-7890",
                  error: errors.phone
                }),
                React.createElement(FormInput, {
                  id: "linkedin",
                  name: "linkedin",
                  label: "LinkedIn URL",
                  value: formData.linkedin,
                  onChange: handleChange,
                  type: "url",
                  placeholder: "https://linkedin.com/in/username",
                  error: errors.linkedin
                }),
                React.createElement(FileInput, {
                  id: "image-upload",
                  label: "Profile Image (JPEG/PNG, max 5MB)",
                  accept: "image/jpeg,image/png",
                  onChange: (e) => handleFileChange(e, 'image'),
                  error: message.includes('image') || message.includes('5MB') ? message : ''
                }),
                React.createElement(FileInput, {
                  id: "cv-upload",
                  label: "Upload CV (PDF, max 10MB)",
                  accept: "application/pdf",
                  onChange: (e) => handleFileChange(e, 'cv'),
                  error: message.includes('PDF') || message.includes('10MB') ? message : ''
                }),
                React.createElement(
                  "div",
                  { className: "mb-4" },
                  React.createElement("label", { className: "block text-sm font-medium text-gray-700 mb-2" }, "Skills"),
                  (formData.skills || []).map((skill, index) =>
                    React.createElement(SkillInput, {
                      key: `skill-${index}`,
                      index,
                      skill,
                      onChange: handleSkillChange,
                      onRemove: removeSkill
                    })
                  ),
                  errors.skills && React.createElement("p", { className: "text-red-500 text-sm mt-1" }, errors.skills),
                  React.createElement(
                    "button",
                    {
                      type: "button",
                      onClick: addSkill,
                      className: "bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500",
                      "aria-label": "Add skill"
                    },
                    "Add Skill"
                  )
                ),
                React.createElement(
                  "div",
                  { className: "mb-4" },
                  React.createElement("label", { className: "block text-sm font-medium text-gray-700 mb-2" }, "Projects"),
                  (formData.projects || []).map((project, index) =>
                    React.createElement(ProjectInput, {
                      key: `project-${index}`,
                      index,
                      project,
                      onChange: handleProjectChange,
                      onRemove: removeProject
                    })
                  ),
                  errors.projects && React.createElement("p", { className: "text-red-500 text-sm mt-1" }, errors.projects),
                  React.createElement(
                    "button",
                    {
                      type: "button",
                      onClick: addProject,
                      className: "bg-green-500 text-white px-3 py-1 rounded-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500",
                      "aria-label": "Add project"
                    },
                    "Add Project"
                  )
                ),
                React.createElement(
                  "div",
                  { className: "mb-4" },
                  React.createElement("label", { htmlFor: "template", className: "block text-sm font-medium text-gray-700 mb-2" }, "Template"),
                  React.createElement(
                    "select",
                    {
                      id: "template",
                      name: "template",
                      value: formData.template || 'default',
                      onChange: handleChange,
                      className: "w-full rounded-md border border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                    },
                    React.createElement("option", { value: "default" }, "Default"),
                    React.createElement("option", { value: "dark" }, "Dark"),
                    React.createElement("option", { value: "vibrant" }, "Vibrant")
                  )
                ),
                React.createElement(
                  "div",
                  { className: "flex gap-4" },
                  React.createElement(
                    "button",
                    {
                      type: "submit",
                      className: `bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:bg-gray-400 disabled:cursor-not-allowed`,
                      "aria-label": "Create portfolio",
                      disabled: isLoading || Object.keys(errors).length > 0
                    },
                    isLoading ? 'Saving...' : 'Create Portfolio'
                  ),
                  React.createElement(
                    "button",
                    {
                      type: "button",
                      onClick: () => {
                        localStorage.removeItem('portfolioForm');
                        setFormData(initialFormData);
                        setImageFile(null);
                        setImagePreview(null);
                        if (cvUrl) URL.revokeObjectURL(cvUrl);
                        setCvFile(null);
                        setCvUrl(null);
                        setErrors({});
                        setMessage('Form cleared!');
                        setTimeout(() => setMessage(''), 2000);
                      },
                      className: "bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500",
                      "aria-label": "Clear form"
                    },
                    "Clear Form"
                  )
                ),
                message &&
                  React.createElement(
                    "p",
                    {
                      className: `mt-2 text-sm ${message.includes('Error') ? 'text-red-500' : 'text-green-600'}`,
                      "aria-live": "polite"
                    },
                    message
                  )
              )
            ),
            React.createElement(PortfolioPreview, {
              formData,
              showPreview,
              togglePreview: () => setShowPreview(!showPreview),
              imagePreview,
              cvFile,
              cvUrl
            })
          )
        );
      };

      const App = () => {
        return React.createElement(
          "div",
          null,
          React.createElement(Header, null),
          React.createElement(PortfolioForm, null),
          React.createElement(BuyMeACoffee, null),
          React.createElement(Footer, null)
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(React.createElement(App, null));
    } catch (error) {
      console.error('Initialization error in portfolio.html:', error.message, error.stack);
    }
  </script>
</body>
</html>
