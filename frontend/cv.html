<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Create an ATS-friendly CV for your job search.">
  <meta name="robots" content="noindex">
  <title>Create Your CV - ePortfolio Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.20.6/babel.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <style>
    body { background: #f3f4f6; font-family: 'Inter', sans-serif; }
    .fade-in { animation: fadeIn 1s ease-in; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .error-message { display: none; color: #dc2626; text-align: center; padding: 1rem; }
    .error .error-message { display: block; }
    .loading { opacity: 0.5; pointer-events: none; }
    .hidden-form { display: none; }
    .preview-container {
      max-width: 800px;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      font-family: Arial, sans-serif;
      line-height: 1.6;
      color: #333;
    }
    .preview-container h1 {
      font-size: 24px;
      text-align: center;
      margin-bottom: 10px;
      color: #2c3e50;
    }
    .preview-container .contact-info {
      text-align: center;
      font-size: 14px;
      margin-bottom: 20px;
    }
    .preview-container .contact-info a {
      color: #2980b9;
      text-decoration: none;
    }
    .preview-container .section {
      margin-bottom: 20px;
    }
    .preview-container .section h2 {
      font-size: 18px;
      border-bottom: 2px solid #2980b9;
      padding-bottom: 5px;
      margin-bottom: 10px;
      color: #2c3e50;
    }
    .preview-container .section ul {
      list-style-type: disc;
      padding-left: 20px;
    }
    .preview-container .job, .preview-container .education, .preview-container .certification {
      margin-bottom: 15px;
    }
    .preview-container .job h3, .preview-container .education h3, .preview-container .certification h3 {
      font-size: 16px;
      margin-bottom: 5px;
      color: #2c3e50;
    }
    .preview-container .job p, .preview-container .education p, .preview-container .certification p {
      margin: 5px 0;
    }
    .preview-container .key-achievements {
      margin-top: 10px;
    }
    .preview-container .key-achievements ul {
      list-style-type: square;
    }
  </style>
</head>
<body class="antialiased">
  <!-- Static form for Netlify Forms detection -->
  <form name="cv" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" class="hidden-form">
    <input type="hidden" name="form-name" value="cv" />
    <input type="hidden" name="bot-field" />
    <input name="name" />
    <input name="email" />
    <input name="location" />
    <input name="phone" />
    <input name="linkedin" />
    <input name="portfolio" />
    <textarea name="summary"></textarea>
    <textarea name="skills"></textarea>
    <textarea name="education"></textarea>
    <textarea name="certifications"></textarea>
    <textarea name="experience"></textarea>
  </form>
  <div id="root"></div>
  <div id="error" className="error-message">
    <p>Error loading the page. Please try refreshing or check the console (F12).</p>
  </div>
  <script type="text/babel">
    try {
      const { useState, useCallback } = React;
      const { jsPDF } = window.jspdf;

      const Header = () => (
        <header className="bg-gradient-to-r from-indigo-600 to-blue-500 text-white py-6 sticky top-0 z-50 shadow-lg fade-in" role="banner">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center">
            <h1 className="text-3xl font-poppins font-bold">ePortfolio Generator</h1>
            <nav className="space-x-6" role="navigation">
              <a href="/index.html#features" className="hover:text-yellow-400 transition">Features</a>
              <a href="/index.html#how-it-works" className="hover:text-yellow-400 transition">How It Works</a>
              <a href="/index.html#faq" className="hover:text-yellow-400 transition">FAQ</a>
              <a href="/index.html#feedback" className="bg-yellow-400 text-gray-900 py-2 px-4 rounded-full font-semibold hover:bg-yellow-500 transition">Feedback</a>
            </nav>
          </div>
        </header>
      );

      const CVPreview = ({ formData }) => (
        <div className="preview-container">
          <h1>{formData.name || "Full Name"}</h1>
          <div className="contact-info">
            <span>{formData.location || "Location"}</span> | 
            <span>{formData.phone || "Phone"}</span> | 
            <span>{formData.email || "Email"}</span> | 
            <a href={formData.linkedin || "#"}>{formData.linkedin ? "LinkedIn" : "LinkedIn"}</a> | 
            <a href={formData.portfolio || "#"}>{formData.portfolio ? "E-portfolio" : "E-portfolio"}</a>
          </div>
          <div className="section">
            <h2>PROFESSIONAL SUMMARY</h2>
            <p>{formData.summary || "Professional Summary"}</p>
          </div>
          <div className="section">
            <h2>SKILLS AND COMPETENCE</h2>
            <ul>
              {formData.skills.filter(skill => skill).length > 0 ? (
                formData.skills.map((skill, index) => skill && <li key={index}>{skill}</li>)
              ) : (
                <li>No skills added yet</li>
              )}
            </ul>
          </div>
          <div className="section">
            <h2>EDUCATION</h2>
            <div>
              {formData.education.filter(edu => edu.degree || edu.institution).length > 0 ? (
                formData.education.map((edu, index) => (
                  (edu.degree || edu.institution) && (
                    <div key={index} className="education">
                      <h3>{edu.degree || "Degree"} | {edu.institution || "Institution"} | {edu.year || "Year"}</h3>
                      {edu.modules && <p><strong>Key Modules:</strong> {edu.modules}</p>}
                    </div>
                  )
                ))
              ) : (
                <p>No education entries added yet</p>
              )}
            </div>
          </div>
          <div className="section">
            <h2>PROFESSIONAL TRAINING AND CERTIFICATIONS</h2>
            <div>
              {formData.certifications.filter(cert => cert.name).length > 0 ? (
                formData.certifications.map((cert, index) => (
                  cert.name && (
                    <div key={index} className="certification">
                      <p>{cert.name} | {cert.year || cert.status || "N/A"}</p>
                    </div>
                  )
                ))
              ) : (
                <p>No certifications added yet</p>
              )}
            </div>
          </div>
          <div className="section">
            <h2>PROFESSIONAL EXPERIENCE</h2>
            <div>
              {formData.experience.filter(exp => exp.company || exp.period).length > 0 ? (
                formData.experience.map((exp, index) => (
                  (exp.company || exp.period) && (
                    <div key={index} className="job">
                      <h3>{exp.company || "Company"} â€“ {exp.location || "Location"}</h3>
                      <p>{exp.period || "Period"}</p>
                      <p><strong>{exp.roles.filter(role => role).join(" / ") || "Roles"}</strong></p>
                      {exp.description && <p>{exp.description}</p>}
                      {exp.achievements.filter(ach => ach).length > 0 && (
                        <div className="key-achievements">
                          <strong>Key Achievements:</strong>
                          <ul>
                            {exp.achievements.map((ach, achIndex) => ach && <li key={achIndex}>{ach}</li>)}
                          </ul>
                        </div>
                      )}
                    </div>
                  )
                ))
              ) : (
                <p>No experience entries added yet</p>
              )}
            </div>
          </div>
          <div className="section">
            <h2>PROFESSIONAL PROJECT EXPERIENCE</h2>
            <p>Please see E-portfolio: <a href={formData.portfolio || "#"}>{formData.portfolio || "Portfolio"}</a></p>
          </div>
        </div>
      );

      const CVForm = () => {
        const [formData, setFormData] = useState({
          name: '',
          email: '',
          location: '',
          phone: '',
          linkedin: '',
          portfolio: '',
          summary: '',
          skills: [''],
          education: [{ degree: '', institution: '', year: '', modules: '' }],
          certifications: [{ name: '', year: '' }],
          experience: [{ company: '', location: '', period: '', roles: [''], description: '', achievements: [''] }],
        });
        const [errors, setErrors] = useState({});
        const [message, setMessage] = useState('');

        const validateUrl = (url) => {
          if (!url) return true;
          const urlRegex = /^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)$/;
          return urlRegex.test(url);
        };

        const validatePhone = (phone) => {
          if (!phone) return true;
          const phoneRegex = /^\+?[1-9]\d{1,14}$|^\d{3}-\d{3}-\d{4}$/;
          return phoneRegex.test(phone);
        };

        const validateForm = () => {
          const newErrors = {};
          if (!formData.name) newErrors.name = 'Full name is required.';
          if (!formData.email) newErrors.email = 'Email is required.';
          else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(formData.email)) {
            newErrors.email = 'Please enter a valid email address.';
          }
          if (formData.phone && !validatePhone(formData.phone)) {
            newErrors.phone = 'Please enter a valid phone number (e.g., +1234567890 or 123-456-7890).';
          }
          if (formData.linkedin && !validateUrl(formData.linkedin)) {
            newErrors.linkedin = 'Please enter a valid LinkedIn URL.';
          }
          if (formData.portfolio && !validateUrl(formData.portfolio)) {
            newErrors.portfolio = 'Please enter a valid portfolio URL.';
          }
          if (!formData.summary) newErrors.summary = 'Professional summary is required.';
          if (formData.summary.length > 1000) newErrors.summary = 'Summary must be 1000 characters or less.';
          if (!formData.skills.some(skill => skill)) newErrors.skills = 'At least one skill is required.';
          if (!formData.education.some(edu => edu.degree && edu.institution)) {
            newErrors.education = 'At least one education entry with degree and institution is required.';
          }
          formData.education.forEach((edu, index) => {
            if (edu.modules && edu.modules.length > 500) {
              newErrors[`education-${index}-modules`] = 'Modules must be 500 characters or less.';
            }
          });
          if (!formData.experience.some(exp => exp.company && exp.period)) {
            newErrors.experience = 'At least one experience entry with company and period is required.';
          }
          formData.experience.forEach((exp, index) => {
            if (exp.description && exp.description.length > 500) {
              newErrors[`experience-${index}-description`] = 'Description must be 500 characters or less.';
            }
          });
          setErrors(newErrors);
          return Object.keys(newErrors).length === 0;
        };

        const handleInputChange = (e, section, index, field, subIndex = null) => {
          const value = e.target.value;
          setFormData((prev) => {
            if (section === 'skills') {
              const newSkills = [...prev.skills];
              newSkills[index] = value;
              return { ...prev, skills: newSkills };
            } else if (section === 'education') {
              const newEducation = [...prev.education];
              newEducation[index][field] = value;
              return { ...prev, education: newEducation };
            } else if (section === 'certifications') {
              const newCertifications = [...prev.certifications];
              newCertifications[index][field] = value;
              return { ...prev, certifications: newCertifications };
            } else if (section === 'experience') {
              const newExperience = [...prev.experience];
              if (field === 'roles' || field === 'achievements') {
                const newArray = [...newExperience[index][field]];
                newArray[subIndex] = value;
                newExperience[index][field] = newArray;
              } else {
                newExperience[index][field] = value;
              }
              return { ...prev, experience: newExperience };
            } else {
              return { ...prev, [e.target.name]: value };
            }
          });
          setErrors({ ...errors, [e.target.name]: '', [`${section}-${index}-${field}`]: '' });
        };

        const addEntry = (section, defaultEntry) => {
          setFormData((prev) => ({
            ...prev,
            [section]: [...prev[section], defaultEntry],
          }));
        };

        const removeEntry = (section, index) => {
          setFormData((prev) => ({
            ...prev,
            [section]: prev[section].filter((_, i) => i !== index),
          }));
        };

        const addSubEntry = (section, index, field, defaultValue) => {
          setFormData((prev) => {
            const newSection = [...prev[section]];
            newSection[index][field] = [...newSection[index][field], defaultValue];
            return { ...prev, [section]: newSection };
          });
        };

        const removeSubEntry = (section, index, field, subIndex) => {
          setFormData((prev) => {
            const newSection = [...prev[section]];
            newSection[index][field] = newSection[index][field].filter((_, i) => i !== subIndex);
            return { ...prev, [section]: newSection };
          });
        };

        const generatePDF = () => {
          const doc = new jsPDF();
          let y = 20;

          const addText = (text, x, maxWidth) => {
            const lines = doc.splitTextToSize(text, maxWidth);
            doc.text(lines, x, y);
            y += lines.length * 7;
          };

          doc.setFontSize(24);
          doc.setFont('helvetica', 'bold');
          addText(formData.name || "Full Name", 20, 170);
          doc.setFontSize(12);
          doc.setFont('helvetica', 'normal');
          addText(
            `${formData.location || "Location"} | ${formData.phone || "Phone"} | ${formData.email || "Email"} | ${formData.linkedin || "LinkedIn"} | ${formData.portfolio || "Portfolio"}`,
            20,
            170
          );
          y += 10;

          doc.setFontSize(18);
          doc.setFont('helvetica', 'bold');
          addText('PROFESSIONAL SUMMARY', 20, 170);
          doc.setLineWidth(0.5);
          doc.line(20, y, 190, y);
          y += 5;
          doc.setFontSize(12);
          doc.setFont('helvetica', 'normal');
          addText(formData.summary || "Professional Summary", 20, 170);
          y += 10;

          doc.setFontSize(18);
          doc.setFont('helvetica', 'bold');
          addText('SKILLS AND COMPETENCE', 20, 170);
          doc.line(20, y, 190, y);
          y += 5;
          doc.setFontSize(12);
          doc.setFont('helvetica', 'normal');
          formData.skills.filter(skill => skill).forEach(skill => {
            addText(`â€¢ ${skill}`, 25, 165);
          });
          y += 10;

          doc.setFontSize(18);
          doc.setFont('helvetica', 'bold');
          addText('EDUCATION', 20, 170);
          doc.line(20, y, 190, y);
          y += 5;
          doc.setFontSize(12);
          formData.education.filter(edu => edu.degree && edu.institution).forEach(edu => {
            doc.setFont('helvetica', 'bold');
            addText(`${edu.degree} | ${edu.institution} | ${edu.year || "Year"}`, 20, 170);
            doc.setFont('helvetica', 'normal');
            if (edu.modules) addText(`Key Modules: ${edu.modules}`, 20, 170);
            y += 5;
          });
          y += 10;

          doc.setFontSize(18);
          doc.setFont('helvetica', 'bold');
          addText('PROFESSIONAL TRAINING AND CERTIFICATIONS', 20, 170);
          doc.line(20, y, 190, y);
          y += 5;
          doc.setFontSize(12);
          doc.setFont('helvetica', 'normal');
          formData.certifications.filter(cert => cert.name).forEach(cert => {
            addText(`${cert.name} | ${cert.year || cert.status || "N/A"}`, 20, 170);
          });
          y += 10;

          doc.setFontSize(18);
          doc.setFont('helvetica', 'bold');
          addText('PROFESSIONAL EXPERIENCE', 20, 170);
          doc.line(20, y, 190, y);
          y += 5;
          doc.setFontSize(12);
          formData.experience.filter(exp => exp.company && exp.period).forEach(exp => {
            doc.setFont('helvetica', 'bold');
            addText(`${exp.company} â€“ ${exp.location || "Location"}`, 20, 170);
            doc.setFont('helvetica', 'normal');
            addText(exp.period, 20, 170);
            doc.setFont('helvetica', 'bold');
            addText(exp.roles.filter(role => role).join(' / '), 20, 170);
            doc.setFont('helvetica', 'normal');
            if (exp.description) addText(exp.description, 20, 170);
            if (exp.achievements.filter(ach => ach).length > 0) {
              addText('Key Achievements:', 20, 170);
              exp.achievements.forEach(ach => {
                if (ach) addText(`â€¢ ${ach}`, 25, 165);
              });
            }
            y += 5;
          });
          y += 10;

          doc.setFontSize(18);
          doc.setFont('helvetica', 'bold');
          addText('PROFESSIONAL PROJECT EXPERIENCE', 20, 170);
          doc.line(20, y, 190, y);
          y += 5;
          doc.setFontSize(12);
          doc.setFont('helvetica', 'normal');
          addText(`Please see E-portfolio: ${formData.portfolio || "Portfolio"}`, 20, 170);

          doc.save('cv.pdf');
        };

        const handleSubmit = useCallback(async (e) => {
          e.preventDefault();
          if (!validateForm()) {
            setMessage('Please fill out all required fields correctly.');
            return;
          }
          setMessage('Submitting CV data...');
          const form = e.target;
          const data = new FormData(form);
          data.append('form-name', 'cv');
          data.append('skills', JSON.stringify(formData.skills.filter(skill => skill)));
          data.append('education', JSON.stringify(formData.education.filter(edu => edu.degree && edu.institution)));
          data.append('certifications', JSON.stringify(formData.certifications.filter(cert => cert.name)));
          data.append('experience', JSON.stringify(formData.experience.filter(exp => exp.company && exp.period)));
          try {
            const response = await fetch('/', {
              method: 'POST',
              headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
              body: new URLSearchParams(data).toString(),
            });
            if (response.ok) {
              generatePDF();
              setMessage('CV submitted and downloaded successfully!');
              setFormData({
                name: '',
                email: '',
                location: '',
                phone: '',
                linkedin: '',
                portfolio: '',
                summary: '',
                skills: [''],
                education: [{ degree: '', institution: '', year: '', modules: '' }],
                certifications: [{ name: '', year: '' }],
                experience: [{ company: '', location: '', period: '', roles: [''], description: '', achievements: [''] }],
              });
            } else {
              setMessage('Error submitting CV. Please try again.');
            }
          } catch (error) {
            console.error('CV submission error:', error);
            setMessage('Error: Unable to submit CV. Please check your connection.');
          }
        }, [formData]);

        return (
          <section className="py-16 bg-white fade-in" role="region" aria-labelledby="cv-form-heading">
            <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
              <h2 id="cv-form-heading" className="text-3xl font-poppins font-bold text-gray-800 mb-8 text-center">Create Your ATS-Friendly CV</h2>
              <form name="cv" method="POST" data-netlify="true" data-netlify-honeypot="bot-field" onSubmit={handleSubmit} className="bg-gray-100 p-8 rounded-xl shadow-lg" role="form" aria-labelledby="cv-form-title">
                <h3 id="cv-form-title" className="sr-only">CV Generator Form</h3>
                <input type="hidden" name="form-name" value="cv" />
                <input type="hidden" name="bot-field" />
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label htmlFor="name" className="block text-sm font-medium text-gray-700">Full Name</label>
                    <input
                      id="name"
                      type="text"
                      name="name"
                      value={formData.name}
                      onChange={(e) => handleInputChange(e)}
                      className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                      required
                      aria-required="true"
                      aria-invalid={errors.name ? 'true' : 'false'}
                      aria-describedby={errors.name ? 'name-error' : undefined}
                    />
                    {errors.name && <p id="name-error" className="text-sm text-red-700 mt-1">{errors.name}</p>}
                  </div>
                  <div>
                    <label htmlFor="email" className="block text-sm font-medium text-gray-700">Email</label>
                    <input
                      id="email"
                      type="email"
                      name="email"
                      value={formData.email}
                      onChange={(e) => handleInputChange(e)}
                      className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                      required
                      aria-required="true"
                      aria-invalid={errors.email ? 'true' : 'false'}
                      aria-describedby={errors.email ? 'email-error' : undefined}
                    />
                    {errors.email && <p id="email-error" className="text-sm text-red-700 mt-1">{errors.email}</p>}
                  </div>
                  <div>
                    <label htmlFor="location" className="block text-sm font-medium text-gray-700">Location</label>
                    <input
                      id="location"
                      type="text"
                      name="location"
                      value={formData.location}
                      onChange={(e) => handleInputChange(e)}
                      className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                    />
                  </div>
                  <div>
                    <label htmlFor="phone" className="block text-sm font-medium text-gray-700">Phone (Optional)</label>
                    <input
                      id="phone"
                      type="tel"
                      name="phone"
                      value={formData.phone}
                      onChange={(e) => handleInputChange(e)}
                      className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                      aria-invalid={errors.phone ? 'true' : 'false'}
                      aria-describedby={errors.phone ? 'phone-error' : undefined}
                    />
                    {errors.phone && <p id="phone-error" className="text-sm text-red-700 mt-1">{errors.phone}</p>}
                  </div>
                  <div>
                    <label htmlFor="linkedin" className="block text-sm font-medium text-gray-700">LinkedIn URL (Optional)</label>
                    <input
                      id="linkedin"
                      type="url"
                      name="linkedin"
                      value={formData.linkedin}
                      onChange={(e) => handleInputChange(e)}
                      className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                      placeholder="https://www.linkedin.com/in/username"
                      aria-invalid={errors.linkedin ? 'true' : 'false'}
                      aria-describedby={errors.linkedin ? 'linkedin-error' : undefined}
                    />
                    {errors.linkedin && <p id="linkedin-error" className="text-sm text-red-700 mt-1">{errors.linkedin}</p>}
                  </div>
                  <div>
                    <label htmlFor="portfolio" className="block text-sm font-medium text-gray-700">Portfolio URL (Optional)</label>
                    <input
                      id="portfolio"
                      type="url"
                      name="portfolio"
                      value={formData.portfolio}
                      onChange={(e) => handleInputChange(e)}
                      className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                      placeholder="https://your-portfolio.com"
                      aria-invalid={errors.portfolio ? 'true' : 'false'}
                      aria-describedby={errors.portfolio ? 'portfolio-error' : undefined}
                    />
                    {errors.portfolio && <p id="portfolio-error" className="text-sm text-red-700 mt-1">{errors.portfolio}</p>}
                  </div>
                  <div className="md:col-span-2">
                    <label htmlFor="summary" className="block text-sm font-medium text-gray-700">Professional Summary</label>
                    <textarea
                      id="summary"
                      name="summary"
                      value={formData.summary}
                      onChange={(e) => handleInputChange(e)}
                      className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                      rows="4"
                      maxLength="1000"
                      required
                      aria-required="true"
                      aria-invalid={errors.summary ? 'true' : 'false'}
                      aria-describedby={errors.summary ? 'summary-error' : 'summary-desc'}
                    />
                    <p id="summary-desc" className="text-sm text-gray-500 mt-1">Brief overview of your professional background (max 1000 characters).</p>
                    {errors.summary && <p id="summary-error" className="text-sm text-red-700 mt-1">{errors.summary}</p>}
                  </div>
                </div>
                <div className="mt-8">
                  <label className="block text-sm font-medium text-gray-700">Skills</label>
                  {formData.skills.map((skill, index) => (
                    <div key={index} className="flex space-x-4 mt-2">
                      <input
                        type="text"
                        value={skill}
                        onChange={(e) => handleInputChange(e, 'skills', index)}
                        placeholder={`Skill ${index + 1}`}
                        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                        aria-label={`Skill ${index + 1}`}
                        aria-invalid={errors.skills ? 'true' : 'false'}
                        aria-describedby={errors.skills ? 'skills-error' : undefined}
                      />
                      {formData.skills.length > 1 && (
                        <button
                          type="button"
                          onClick={() => removeEntry('skills', index)}
                          className="bg-red-500 text-white px-2 py-1 rounded-md hover:bg-red-600"
                          aria-label={`Remove skill ${index + 1}`}
                        >
                          Remove
                        </button>
                      )}
                    </div>
                  ))}
                  {errors.skills && <p id="skills-error" className="text-sm text-red-700 mt-1">{errors.skills}</p>}
                  <button
                    type="button"
                    onClick={() => addEntry('skills', '')}
                    className="mt-2 bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600"
                    aria-label="Add another skill"
                  >
                    Add Skill
                  </button>
                </div>
                <div className="mt-8">
                  <label className="block text-sm font-medium text-gray-700">Education</label>
                  {formData.education.map((edu, index) => (
                    <div key={index} className="mt-4 p-4 bg-gray-50 rounded-lg">
                      <input
                        type="text"
                        value={edu.degree}
                        onChange={(e) => handleInputChange(e, 'education', index, 'degree')}
                        placeholder="Degree"
                        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50 mb-2"
                        aria-label={`Education ${index + 1} degree`}
                        aria-invalid={errors.education ? 'true' : 'false'}
                        aria-describedby={errors.education ? 'education-error' : undefined}
                      />
                      <input
                        type="text"
                        value={edu.institution}
                        onChange={(e) => handleInputChange(e, 'education', index, 'institution')}
                        placeholder="Institution"
                        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50 mb-2"
                        aria-label={`Education ${index + 1} institution`}
                      />
                      <input
                        type="text"
                        value={edu.year}
                        onChange={(e) => handleInputChange(e, 'education', index, 'year')}
                        placeholder="Year"
                        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50 mb-2"
                        aria-label={`Education ${index + 1} year`}
                      />
                      <textarea
                        value={edu.modules}
                        onChange={(e) => handleInputChange(e, 'education', index, 'modules')}
                        placeholder="Key Modules (Optional)"
                        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50 mb-2"
                        rows="3"
                        maxLength="500"
                        aria-label={`Education ${index + 1} modules`}
                        aria-invalid={errors[`education-${index}-modules`] ? 'true' : 'false'}
                        aria-describedby={errors[`education-${index}-modules`] ? `education-${index}-modules-error` : undefined}
                      />
                      {errors[`education-${index}-modules`] && (
                        <p id={`education-${index}-modules-error`} className="text-sm text-red-700 mt-1">{errors[`education-${index}-modules`]}</p>
                      )}
                      {formData.education.length > 1 && (
                        <button
                          type="button"
                          onClick={() => removeEntry('education', index)}
                          className="bg-red-500 text-white px-2 py-1 rounded-md hover:bg-red-600"
                          aria-label={`Remove education ${index + 1}`}
                        >
                          Remove
                        </button>
                      )}
                    </div>
                  ))}
                  {errors.education && <p id="education-error" className="text-sm text-red-700 mt-1">{errors.education}</p>}
                  <button
                    type="button"
                    onClick={() => addEntry('education', { degree: '', institution: '', year: '', modules: '' })}
                    className="mt-2 bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600"
                    aria-label="Add another education entry"
                  >
                    Add Education
                  </button>
                </div>
                <div className="mt-8">
                  <label className="block text-sm font-medium text-gray-700">Certifications</label>
                  {formData.certifications.map((cert, index) => (
                    <div key={index} className="flex space-x-4 mt-2">
                      <input
                        type="text"
                        value={cert.name}
                        onChange={(e) => handleInputChange(e, 'certifications', index, 'name')}
                        placeholder="Certification Name"
                        className="block w-3/4 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                        aria-label={`Certification ${index + 1} name`}
                      />
                      <input
                        type="text"
                        value={cert.year}
                        onChange={(e) => handleInputChange(e, 'certifications', index, 'year')}
                        placeholder="Year or Status"
                        className="block w-1/4 rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                        aria-label={`Certification ${index + 1} year or status`}
                      />
                      {formData.certifications.length > 1 && (
                        <button
                          type="button"
                          onClick={() => removeEntry('certifications', index)}
                          className="bg-red-500 text-white px-2 py-1 rounded-md hover:bg-red-600"
                          aria-label={`Remove certification ${index + 1}`}
                        >
                          Remove
                        </button>
                      )}
                    </div>
                  ))}
                  <button
                    type="button"
                    onClick={() => addEntry('certifications', { name: '', year: '' })}
                    className="mt-2 bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600"
                    aria-label="Add another certification"
                  >
                    Add Certification
                  </button>
                </div>
                <div className="mt-8">
                  <label className="block text-sm font-medium text-gray-700">Professional Experience</label>
                  {formData.experience.map((exp, index) => (
                    <div key={index} className="mt-4 p-4 bg-gray-50 rounded-lg">
                      <input
                        type="text"
                        value={exp.company}
                        onChange={(e) => handleInputChange(e, 'experience', index, 'company')}
                        placeholder="Company"
                        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50 mb-2"
                        aria-label={`Experience ${index + 1} company`}
                        aria-invalid={errors.experience ? 'true' : 'false'}
                        aria-describedby={errors.experience ? 'experience-error' : undefined}
                      />
                      <input
                        type="text"
                        value={exp.location}
                        onChange={(e) => handleInputChange(e, 'experience', index, 'location')}
                        placeholder="Location"
                        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50 mb-2"
                        aria-label={`Experience ${index + 1} location`}
                      />
                      <input
                        type="text"
                        value={exp.period}
                        onChange={(e) => handleInputChange(e, 'experience', index, 'period')}
                        placeholder="Period (e.g., Jan 2020 - Present)"
                        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50 mb-2"
                        aria-label={`Experience ${index + 1} period`}
                      />
                      {exp.roles.map((role, roleIndex) => (
                        <div key={roleIndex} className="flex space-x-4 mb-2">
                          <input
                            type="text"
                            value={role}
                            onChange={(e) => handleInputChange(e, 'experience', index, 'roles', roleIndex)}
                            placeholder={`Role ${roleIndex + 1}`}
                            className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                            aria-label={`Experience ${index + 1} role ${roleIndex + 1}`}
                          />
                          {exp.roles.length > 1 && (
                            <button
                              type="button"
                              onClick={() => removeSubEntry('experience', index, 'roles', roleIndex)}
                              className="bg-red-500 text-white px-2 py-1 rounded-md hover:bg-red-600"
                              aria-label={`Remove role ${roleIndex + 1} from experience ${index + 1}`}
                            >
                              Remove
                            </button>
                          )}
                        </div>
                      ))}
                      <button
                        type="button"
                        onClick={() => addSubEntry('experience', index, 'roles', '')}
                        className="bg-green-500 text-white px-2 py-1 rounded-md hover:bg-green-600 mb-2"
                        aria-label={`Add role to experience ${index + 1}`}
                      >
                        Add Role
                      </button>
                      <textarea
                        value={exp.description}
                        onChange={(e) => handleInputChange(e, 'experience', index, 'description')}
                        placeholder="Description"
                        className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50 mb-2"
                        rows="3"
                        maxLength="500"
                        aria-label={`Experience ${index + 1} description`}
                        aria-invalid={errors[`experience-${index}-description`] ? 'true' : 'false'}
                        aria-describedby={errors[`experience-${index}-description`] ? `experience-${index}-description-error` : undefined}
                      />
                      {errors[`experience-${index}-description`] && (
                        <p id={`experience-${index}-description-error`} className="text-sm text-red-700 mt-1">{errors[`experience-${index}-description`]}</p>
                      )}
                      {exp.achievements.map((ach, achIndex) => (
                        <div key={achIndex} className="flex space-x-4 mb-2">
                          <input
                            type="text"
                            value={ach}
                            onChange={(e) => handleInputChange(e, 'experience', index, 'achievements', achIndex)}
                            placeholder={`Achievement ${achIndex + 1}`}
                            className="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                            aria-label={`Experience ${index + 1} achievement ${achIndex + 1}`}
                          />
                          {exp.achievements.length > 1 && (
                            <button
                              type="button"
                              onClick={() => removeSubEntry('experience', index, 'achievements', achIndex)}
                              className="bg-red-500 text-white px-2 py-1 rounded-md hover:bg-red-600"
                              aria-label={`Remove achievement ${achIndex + 1} from experience ${index + 1}`}
                            >
                              Remove
                            </button>
                          )}
                        </div>
                      ))}
                      <button
                        type="button"
                        onClick={() => addSubEntry('experience', index, 'achievements', '')}
                        className="bg-green-500 text-white px-2 py-1 rounded-md hover:bg-green-600 mb-2"
                        aria-label={`Add achievement to experience ${index + 1}`}
                      >
                        Add Achievement
                      </button>
                      {formData.experience.length > 1 && (
                        <button
                          type="button"
                          onClick={() => removeEntry('experience', index)}
                          className="bg-red-500 text-white px-2 py-1 rounded-md hover:bg-red-600"
                          aria-label={`Remove experience ${index + 1}`}
                        >
                          Remove Experience
                        </button>
                      )}
                    </div>
                  ))}
                  {errors.experience && <p id="experience-error" className="text-sm text-red-700 mt-1">{errors.experience}</p>}
                  <button
                    type="button"
                    onClick={() => addEntry('experience', { company: '', location: '', period: '', roles: [''], description: '', achievements: [''] })}
                    className="mt-2 bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600"
                    aria-label="Add another experience"
                  >
                    Add Experience
                  </button>
                </div>
                <button
                  type="submit"
                  className="mt-8 w-full bg-indigo-600 text-white py-3 px-6 rounded-full font-semibold hover:bg-indigo-700 focus:outline-none focus:ring focus:ring-indigo-500 focus:ring-opacity-50"
                  aria-label="Generate CV"
                >
                  Generate CV
                </button>
                {message && (
                  <div className={`mt-6 text-center p-4 rounded-lg ${message.includes('Error') ? 'bg-red-100 text-red-700' : 'bg-green-100 text-green-700'}`} role="alert" aria-live="polite">
                    {message}
                  </div>
                )}
              </form>
              <h3 className="text-2xl font-poppins font-bold text-gray-800 mt-12 mb-6 text-center">Live Preview</h3>
              <CVPreview formData={formData} />
            </div>
          </section>
        );
      };

      const App = () => (
        <div className="min-h-screen bg-gray-50">
          <Header />
          <main>
            <CVForm />
          </main>
          <footer className="bg-gray-800 text-white py-8 fade-in" role="contentinfo">
            <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
              <p className="mb-4">Support this free tool!</p>
              <a
                href="https://buymeacoffee.com/eportfoliogen"
                target="_blank"
                rel="noopener noreferrer"
                className="inline-block bg-yellow-400 text-gray-900 py-3 px-8 rounded-full font-semibold hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-yellow-500"
                aria-label="Support us on Buy Me a Coffee"
              >
                Buy Me a Coffee
              </a>
              <p className="mt-4 text-sm">Â© 2025 ePortfolio Generator. All rights reserved.</p>
              <nav className="mt-4 space-x-4" aria-label="Footer navigation">
                <a href="/index.html#features" className="hover:text-yellow-400 transition">Features</a>
                <a href="/index.html#how-it-works" className="hover:text-yellow-400 transition">How It Works</a>
                <a href="/index.html#faq" className="hover:text-yellow-400 transition">FAQ</a>
              </nav>
            </div>
          </footer>
        </div>
      );

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    } catch (error) {
      console.error('Error rendering cv.html:', error);
      document.getElementById('error').className = 'error-message error';
    }
  </script>
</body>
</html>
